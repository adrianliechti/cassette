(function (g, f) {
    if ("object" == typeof exports && "object" == typeof module) {
      module.exports = f();
    } else if ("function" == typeof define && define.amd) {
      define("rrweb", [], f);
    } else if ("object" == typeof exports) {
      exports["rrweb"] = f();
    } else {
      g["rrweb"] = f();
    }
  }(this, () => {
var exports = {};
var module = { exports };
"use strict";var Zt=Object.defineProperty,Vt=Object.defineProperties;var Ut=Object.getOwnPropertyDescriptors;var be=Object.getOwnPropertySymbols;var qe=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var $e=(e,t,r)=>t in e?Zt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_=(e,t)=>{for(var r in t||(t={}))qe.call(t,r)&&$e(e,r,t[r]);if(be)for(var r of be(t))et.call(t,r)&&$e(e,r,t[r]);return e},we=(e,t)=>Vt(e,Ut(t));var tt=(e,t)=>{var r={};for(var n in e)qe.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&be)for(var n of be(e))t.indexOf(n)<0&&et.call(e,n)&&(r[n]=e[n]);return r};Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var Xt=Object.defineProperty,Jt=(e,t,r)=>t in e?Xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t,r)=>(Jt(e,typeof t!="symbol"?t+"":t,r),r),rt,jt=Object.defineProperty,Kt=(e,t,r)=>t in e?jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nt=(e,t,r)=>(Kt(e,typeof t!="symbol"?t+"":t,r),r),L=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(L||{});function Qt(e){return e.nodeType===e.ELEMENT_NODE}function he(e){const t=e==null?void 0:e.host;return(t==null?void 0:t.shadowRoot)===e}function pe(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function $t(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e}function qt(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const r=["@import",`url(${JSON.stringify(e.href)})`];return e.layerName===""?r.push("layer"):e.layerName&&r.push(`layer(${e.layerName})`),e.supportsText&&r.push(`supports(${e.supportsText})`),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}function Re(e){try{const t=e.rules||e.cssRules;return t?$t(Array.from(t,St).join("")):null}catch(t){return null}}function St(e){let t;if(tr(e))try{t=Re(e.styleSheet)||qt(e)}catch(r){}else if(rr(e)&&e.selectorText.includes(":"))return er(e.cssText);return t||e.cssText}function er(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}function tr(e){return"styleSheet"in e}function rr(e){return"selectorText"in e}class Ct{constructor(){nt(this,"idNodeMap",new Map),nt(this,"nodeMetaMap",new WeakMap)}getId(t){var r;if(!t)return-1;const n=(r=this.getMeta(t))==null?void 0:r.id;return n!=null?n:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(n=>this.removeNodeFromMap(n))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,r){const n=r.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,r)}replace(t,r){const n=this.getNode(t);if(n){const s=this.nodeMetaMap.get(n);s&&this.nodeMetaMap.set(r,s)}this.idNodeMap.set(t,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function nr(){return new Ct}function Ue({element:e,maskInputOptions:t,tagName:r,type:n,value:s,maskInputFn:i}){let a=s||"";const l=n&&re(n);return(t[r.toLowerCase()]||l&&t[l])&&(i?a=i(a,e):a="*".repeat(a.length)),a}function re(e){return e.toLowerCase()}const st="__rrweb_original__";function sr(e){const t=e.getContext("2d");if(!t)return!0;const r=50;for(let n=0;n<e.width;n+=r)for(let s=0;s<e.height;s+=r){const i=t.getImageData,a=st in i?i[st]:i;if(new Uint32Array(a.call(t,n,s,Math.min(r,e.width-n),Math.min(r,e.height-s)).data.buffer).some(o=>o!==0))return!1}return!0}function Xe(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?re(t):null}function bt(e,t){var i;let r;try{r=new URL(e,t!=null?t:window.location.href)}catch(a){return null}const n=/\.([0-9a-z]+)(?:$)/i,s=r.pathname.match(n);return(i=s==null?void 0:s[1])!=null?i:null}let or=1;const ir=new RegExp("[^a-z0-9-_:]"),me=-2;function wt(){return or++}function ar(e){if(e instanceof HTMLFormElement)return"form";const t=re(e.tagName);return ir.test(t)?"div":t}function lr(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}let ne,ot;const cr=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,dr=/^(?:[a-z+]+:)?\/\//i,ur=/^www\..*/i,hr=/^(data:)([^,]*),(.*)/i;function Te(e,t){return(e||"").replace(cr,(r,n,s,i,a,l)=>{const o=s||a||l,d=n||i||"";if(!o)return r;if(dr.test(o)||ur.test(o))return`url(${d}${o}${d})`;if(hr.test(o))return`url(${d}${o}${d})`;if(o[0]==="/")return`url(${d}${lr(t)+o}${d})`;const u=t.split("/"),h=o.split("/");u.pop();for(const m of h)m!=="."&&(m===".."?u.pop():u.push(m));return`url(${d}${u.join("/")}${d})`})}const pr=/^[^ \t\n\r\u000c]+/,fr=/^[, \t\n\r\u000c]+/;function mr(e,t){if(t.trim()==="")return t;let r=0;function n(i){let a;const l=i.exec(t.substring(r));return l?(a=l[0],r+=a.length,a):""}const s=[];for(;n(fr),!(r>=t.length);){let i=n(pr);if(i.slice(-1)===",")i=ie(e,i.substring(0,i.length-1)),s.push(i);else{let a="";i=ie(e,i);let l=!1;for(;;){const o=t.charAt(r);if(o===""){s.push((i+a).trim());break}else if(l)o===")"&&(l=!1);else if(o===","){r+=1,s.push((i+a).trim());break}else o==="("&&(l=!0);a+=o,r+=1}}}return s.join(", ")}const it=new WeakMap;function ie(e,t){return!t||t.trim()===""?t:Le(e,t)}function gr(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function Le(e,t){let r=it.get(e);if(r||(r=e.createElement("a"),it.set(e,r)),!t)t="";else if(t.startsWith("blob:")||t.startsWith("data:"))return t;return r.setAttribute("href",t),r.href}function vt(e,t,r,n){return n&&(r==="src"||r==="href"&&!(t==="use"&&n[0]==="#")||r==="xlink:href"&&n[0]!=="#"||r==="background"&&(t==="table"||t==="td"||t==="th")?ie(e,n):r==="srcset"?mr(e,n):r==="style"?Te(n,Le(e)):t==="object"&&r==="data"?ie(e,n):n)}function Mt(e,t,r){return(e==="video"||e==="audio")&&t==="autoplay"}function yr(e,t,r){try{if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const s=e.classList[n];if(t.test(s))return!0}if(r)return e.matches(r)}catch(n){}return!1}function Oe(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return r?Oe(e.parentNode,t,r):!1;for(let n=e.classList.length;n--;){const s=e.classList[n];if(t.test(s))return!0}return r?Oe(e.parentNode,t,r):!1}function At(e,t,r,n){try{const s=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(s===null)return!1;if(typeof t=="string"){if(n){if(s.closest(`.${t}`))return!0}else if(s.classList.contains(t))return!0}else if(Oe(s,t,n))return!0;if(r){if(n){if(s.closest(r))return!0}else if(s.matches(r))return!0}}catch(s){}return!1}function Ir(e,t,r){const n=e.contentWindow;if(!n)return;let s=!1,i;try{i=n.document.readyState}catch(l){return}if(i!=="complete"){const l=setTimeout(()=>{s||(t(),s=!0)},r);e.addEventListener("load",()=>{clearTimeout(l),s=!0,t()});return}const a="about:blank";if(n.location.href!==a||e.src===a||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}function Sr(e,t,r){let n=!1,s;try{s=e.sheet}catch(a){return}if(s)return;const i=setTimeout(()=>{n||(t(),n=!0)},r);e.addEventListener("load",()=>{clearTimeout(i),n=!0,t()})}function Cr(e,t){const{doc:r,mirror:n,blockClass:s,blockSelector:i,needsMask:a,inlineStylesheet:l,maskInputOptions:o={},maskTextFn:d,maskInputFn:u,dataURLOptions:h={},inlineImages:m,recordCanvas:p,keepIframeSrcFn:y,newlyAddedElement:c=!1}=t,I=br(r,n);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:L.Document,childNodes:[],compatMode:e.compatMode}:{type:L.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:L.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:I};case e.ELEMENT_NODE:return vr(e,{doc:r,blockClass:s,blockSelector:i,inlineStylesheet:l,maskInputOptions:o,maskInputFn:u,dataURLOptions:h,inlineImages:m,recordCanvas:p,keepIframeSrcFn:y,newlyAddedElement:c,rootId:I});case e.TEXT_NODE:return wr(e,{doc:r,needsMask:a,maskTextFn:d,rootId:I});case e.CDATA_SECTION_NODE:return{type:L.CDATA,textContent:"",rootId:I};case e.COMMENT_NODE:return{type:L.Comment,textContent:e.textContent||"",rootId:I};default:return!1}}function br(e,t){if(!t.hasNode(e))return;const r=t.getId(e);return r===1?void 0:r}function wr(e,t){var r;const{needsMask:n,maskTextFn:s,rootId:i}=t,a=e.parentNode&&e.parentNode.tagName;let l=e.textContent;const o=a==="STYLE"?!0:void 0,d=a==="SCRIPT"?!0:void 0;if(o&&l){try{e.nextSibling||e.previousSibling||(r=e.parentNode.sheet)!=null&&r.cssRules&&(l=Re(e.parentNode.sheet))}catch(u){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${u}`,e)}l=Te(l,Le(t.doc))}return d&&(l="SCRIPT_PLACEHOLDER"),!o&&!d&&l&&n&&(l=s?s(l,e.parentElement):l.replace(/[\S]/g,"*")),{type:L.Text,textContent:l||"",isStyle:o,rootId:i}}function vr(e,t){const{doc:r,blockClass:n,blockSelector:s,inlineStylesheet:i,maskInputOptions:a={},maskInputFn:l,dataURLOptions:o={},inlineImages:d,recordCanvas:u,keepIframeSrcFn:h,newlyAddedElement:m=!1,rootId:p}=t,y=yr(e,n,s),c=ar(e);let I={};const C=e.attributes.length;for(let f=0;f<C;f++){const b=e.attributes[f];Mt(c,b.name,b.value)||(I[b.name]=vt(r,c,re(b.name),b.value))}if(c==="link"&&i){const f=Array.from(r.styleSheets).find(T=>T.href===e.href);let b=null;f&&(b=Re(f)),b&&(delete I.rel,delete I.href,I._cssText=Te(b,f.href))}if(c==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const f=Re(e.sheet);f&&(I._cssText=Te(f,Le(r)))}if(c==="input"||c==="textarea"||c==="select"){const f=e.value,b=e.checked;I.type!=="radio"&&I.type!=="checkbox"&&I.type!=="submit"&&I.type!=="button"&&f?I.value=Ue({element:e,type:Xe(e),tagName:c,value:f,maskInputOptions:a,maskInputFn:l}):b&&(I.checked=b)}if(c==="option"&&(e.selected&&!a.select?I.selected=!0:delete I.selected),c==="canvas"&&u){if(e.__context==="2d")sr(e)||(I.rr_dataURL=e.toDataURL(o.type,o.quality));else if(!("__context"in e)){const f=e.toDataURL(o.type,o.quality),b=r.createElement("canvas");b.width=e.width,b.height=e.height;const T=b.toDataURL(o.type,o.quality);f!==T&&(I.rr_dataURL=f)}}if(c==="img"&&d){ne||(ne=r.createElement("canvas"),ot=ne.getContext("2d"));const f=e,b=f.currentSrc||f.getAttribute("src")||"<unknown-src>",T=f.crossOrigin,x=()=>{f.removeEventListener("load",x);try{ne.width=f.naturalWidth,ne.height=f.naturalHeight,ot.drawImage(f,0,0),I.rr_dataURL=ne.toDataURL(o.type,o.quality)}catch(B){if(f.crossOrigin!=="anonymous"){f.crossOrigin="anonymous",f.complete&&f.naturalWidth!==0?x():f.addEventListener("load",x);return}else console.warn(`Cannot inline img src=${b}! Error: ${B}`)}f.crossOrigin==="anonymous"&&(T?I.crossOrigin=T:f.removeAttribute("crossorigin"))};f.complete&&f.naturalWidth!==0?x():f.addEventListener("load",x)}if(c==="audio"||c==="video"){const f=I;f.rr_mediaState=e.paused?"paused":"played",f.rr_mediaCurrentTime=e.currentTime,f.rr_mediaPlaybackRate=e.playbackRate,f.rr_mediaMuted=e.muted,f.rr_mediaLoop=e.loop,f.rr_mediaVolume=e.volume}if(m||(e.scrollLeft&&(I.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(I.rr_scrollTop=e.scrollTop)),y){const{width:f,height:b}=e.getBoundingClientRect();I={class:I.class,rr_width:`${f}px`,rr_height:`${b}px`}}c==="iframe"&&!h(I.src)&&(e.contentDocument||(I.rr_src=I.src),delete I.src);let S;try{customElements.get(c)&&(S=!0)}catch(f){}return{type:L.Element,tagName:c,attributes:I,childNodes:[],isSVG:gr(e)||void 0,needBlock:y,rootId:p,isCustom:S}}function R(e){return e==null?"":e.toLowerCase()}function Mr(e,t){if(t.comment&&e.type===L.Comment)return!0;if(e.type===L.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&bt(e.attributes.href)==="js"))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(R(e.attributes.name).match(/^msapplication-tile(image|color)$/)||R(e.attributes.name)==="application-name"||R(e.attributes.rel)==="icon"||R(e.attributes.rel)==="apple-touch-icon"||R(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&R(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(R(e.attributes.property).match(/^(og|twitter|fb):/)||R(e.attributes.name).match(/^(og|twitter):/)||R(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(R(e.attributes.name)==="robots"||R(e.attributes.name)==="googlebot"||R(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(R(e.attributes.name)==="author"||R(e.attributes.name)==="generator"||R(e.attributes.name)==="framework"||R(e.attributes.name)==="publisher"||R(e.attributes.name)==="progid"||R(e.attributes.property).match(/^article:/)||R(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(R(e.attributes.name)==="google-site-verification"||R(e.attributes.name)==="yandex-verification"||R(e.attributes.name)==="csrf-token"||R(e.attributes.name)==="p:domain_verify"||R(e.attributes.name)==="verify-v1"||R(e.attributes.name)==="verification"||R(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function ae(e,t){const{doc:r,mirror:n,blockClass:s,blockSelector:i,maskTextClass:a,maskTextSelector:l,skipChild:o=!1,inlineStylesheet:d=!0,maskInputOptions:u={},maskTextFn:h,maskInputFn:m,slimDOMOptions:p,dataURLOptions:y={},inlineImages:c=!1,recordCanvas:I=!1,onSerialize:C,onIframeLoad:S,iframeLoadTimeout:f=5e3,onStylesheetLoad:b,stylesheetLoadTimeout:T=5e3,keepIframeSrcFn:x=()=>!1,newlyAddedElement:B=!1}=t;let{needsMask:F}=t,{preserveWhiteSpace:X=!0}=t;!F&&e.childNodes&&(F=At(e,a,l,F===void 0));const z=Cr(e,{doc:r,mirror:n,blockClass:s,blockSelector:i,needsMask:F,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:m,dataURLOptions:y,inlineImages:c,recordCanvas:I,keepIframeSrcFn:x,newlyAddedElement:B});if(!z)return console.warn(e,"not serialized"),null;let Y;n.hasNode(e)?Y=n.getId(e):Mr(z,p)||!X&&z.type===L.Text&&!z.isStyle&&!z.textContent.replace(/^\s+|\s+$/gm,"").length?Y=me:Y=wt();const A=Object.assign(z,{id:Y});if(n.add(e,A),Y===me)return null;C&&C(e);let $=!o;if(A.type===L.Element){$=$&&!A.needBlock,delete A.needBlock;const W=e.shadowRoot;W&&pe(W)&&(A.isShadowHost=!0)}if((A.type===L.Document||A.type===L.Element)&&$){p.headWhitespace&&A.type===L.Element&&A.tagName==="head"&&(X=!1);const W={doc:r,mirror:n,blockClass:s,blockSelector:i,needsMask:F,maskTextClass:a,maskTextSelector:l,skipChild:o,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:m,slimDOMOptions:p,dataURLOptions:y,inlineImages:c,recordCanvas:I,preserveWhiteSpace:X,onSerialize:C,onIframeLoad:S,iframeLoadTimeout:f,onStylesheetLoad:b,stylesheetLoadTimeout:T,keepIframeSrcFn:x};if(!(A.type===L.Element&&A.tagName==="textarea"&&A.attributes.value!==void 0))for(const K of Array.from(e.childNodes)){const Z=ae(K,W);Z&&A.childNodes.push(Z)}if(Qt(e)&&e.shadowRoot)for(const K of Array.from(e.shadowRoot.childNodes)){const Z=ae(K,W);Z&&(pe(e.shadowRoot)&&(Z.isShadow=!0),A.childNodes.push(Z))}}return e.parentNode&&he(e.parentNode)&&pe(e.parentNode)&&(A.isShadow=!0),A.type===L.Element&&A.tagName==="iframe"&&Ir(e,()=>{const W=e.contentDocument;if(W&&S){const K=ae(W,{doc:W,mirror:n,blockClass:s,blockSelector:i,needsMask:F,maskTextClass:a,maskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:m,slimDOMOptions:p,dataURLOptions:y,inlineImages:c,recordCanvas:I,preserveWhiteSpace:X,onSerialize:C,onIframeLoad:S,iframeLoadTimeout:f,onStylesheetLoad:b,stylesheetLoadTimeout:T,keepIframeSrcFn:x});K&&S(e,K)}},f),A.type===L.Element&&A.tagName==="link"&&typeof A.attributes.rel=="string"&&(A.attributes.rel==="stylesheet"||A.attributes.rel==="preload"&&typeof A.attributes.href=="string"&&bt(A.attributes.href)==="css")&&Sr(e,()=>{if(b){const W=ae(e,{doc:r,mirror:n,blockClass:s,blockSelector:i,needsMask:F,maskTextClass:a,maskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:m,slimDOMOptions:p,dataURLOptions:y,inlineImages:c,recordCanvas:I,preserveWhiteSpace:X,onSerialize:C,onIframeLoad:S,iframeLoadTimeout:f,onStylesheetLoad:b,stylesheetLoadTimeout:T,keepIframeSrcFn:x});W&&b(e,W)}},T),A}function Ar(e,t){const{mirror:r=new Ct,blockClass:n="rr-block",blockSelector:s=null,maskTextClass:i="rr-mask",maskTextSelector:a=null,inlineStylesheet:l=!0,inlineImages:o=!1,recordCanvas:d=!1,maskAllInputs:u=!1,maskTextFn:h,maskInputFn:m,slimDOM:p=!1,dataURLOptions:y,preserveWhiteSpace:c,onSerialize:I,onIframeLoad:C,iframeLoadTimeout:S,onStylesheetLoad:f,stylesheetLoadTimeout:b,keepIframeSrcFn:T=()=>!1}=t||{};return ae(e,{doc:e,mirror:r,blockClass:n,blockSelector:s,maskTextClass:i,maskTextSelector:a,skipChild:!1,inlineStylesheet:l,maskInputOptions:u===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:u===!1?{password:!0}:u,maskTextFn:h,maskInputFn:m,slimDOMOptions:p===!0||p==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:p==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:p===!1?{}:p,dataURLOptions:y,inlineImages:o,recordCanvas:d,preserveWhiteSpace:c,onSerialize:I,onIframeLoad:C,iframeLoadTimeout:S,onStylesheetLoad:f,stylesheetLoadTimeout:b,keepIframeSrcFn:T,newlyAddedElement:!1})}function G(e,t,r=document){const n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}const se=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let at={map:{},getId(){return console.error(se),-1},getNode(){return console.error(se),null},removeNodeFromMap(){console.error(se)},has(){return console.error(se),!1},reset(){console.error(se)}};typeof window!="undefined"&&window.Proxy&&window.Reflect&&(at=new Proxy(at,{get(e,t,r){return t==="map"&&console.error(se),Reflect.get(e,t,r)}}));function ge(e,t,r={}){let n=null,s=0;return function(...i){const a=Date.now();!s&&r.leading===!1&&(s=a);const l=t-(a-s),o=this;l<=0||l>t?(n&&(clearTimeout(n),n=null),s=a,e.apply(o,i)):!n&&r.trailing!==!1&&(n=setTimeout(()=>{s=r.leading===!1?0:Date.now(),n=null,e.apply(o,i)},l))}}function _e(e,t,r,n,s=window){const i=s.Object.getOwnPropertyDescriptor(e,t);return s.Object.defineProperty(e,t,n?r:{set(a){setTimeout(()=>{r.set.call(this,a)},0),i&&i.set&&i.set.call(this,a)}}),()=>_e(e,t,i||{},!0)}function de(e,t,r){try{if(!(t in e))return()=>{};const n=e[t],s=r(n);return typeof s=="function"&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=s,()=>{e[t]=n}}catch(n){return()=>{}}}let De=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(De=()=>new Date().getTime());function Nt(e){var t,r,n,s,i,a;const l=e.document;return{left:l.scrollingElement?l.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:(l==null?void 0:l.documentElement.scrollLeft)||((r=(t=l==null?void 0:l.body)==null?void 0:t.parentElement)==null?void 0:r.scrollLeft)||((n=l==null?void 0:l.body)==null?void 0:n.scrollLeft)||0,top:l.scrollingElement?l.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:(l==null?void 0:l.documentElement.scrollTop)||((i=(s=l==null?void 0:l.body)==null?void 0:s.parentElement)==null?void 0:i.scrollTop)||((a=l==null?void 0:l.body)==null?void 0:a.scrollTop)||0}}function kt(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Rt(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Tt(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}function P(e,t,r,n){if(!e)return!1;const s=Tt(e);if(!s)return!1;try{if(typeof t=="string"){if(s.classList.contains(t)||n&&s.closest("."+t)!==null)return!0}else if(Oe(s,t,n))return!0}catch(i){}return!!(r&&(s.matches(r)||n&&s.closest(r)!==null))}function Nr(e,t){return t.getId(e)!==-1}function He(e,t,r){return e.tagName==="TITLE"&&r.headTitleMutations?!0:t.getId(e)===me}function Ot(e,t){if(he(e))return!1;const r=t.getId(e);return t.has(r)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?Ot(e.parentNode,t):!0:!0}function Ye(e){return!!e.changedTouches}function kr(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let r=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}function Dt(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function Et(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function Ze(e){return!!(e!=null&&e.shadowRoot)}class Rr{constructor(){g(this,"id",1),g(this,"styleIDMap",new WeakMap),g(this,"idStyleMap",new Map)}getId(t){var r;return(r=this.styleIDMap.get(t))!=null?r:-1}has(t){return this.styleIDMap.has(t)}add(t,r){if(this.has(t))return this.getId(t);let n;return r===void 0?n=this.id++:n=r,this.styleIDMap.set(t,n),this.idStyleMap.set(n,t),n}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function xt(e){var t,r;let n=null;return((r=(t=e.getRootNode)==null?void 0:t.call(e))==null?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(n=e.getRootNode().host),n}function Tr(e){let t=e,r;for(;r=xt(t);)t=r;return t}function Or(e){const t=e.ownerDocument;if(!t)return!1;const r=Tr(e);return t.contains(r)}function Lt(e){const t=e.ownerDocument;return t?t.contains(e)||Or(e):!1}var M=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(M||{}),w=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(w||{}),H=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(H||{}),j=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(j||{}),ce=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(ce||{}),oe=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(oe||{});function lt(e){return"__ln"in e}class Dr{constructor(){g(this,"length",0),g(this,"head",null),g(this,"tail",null)}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let n=0;n<t;n++)r=(r==null?void 0:r.next)||null;return r}addNode(t){const r={value:t,previous:null,next:null};if(t.__ln=r,t.previousSibling&&lt(t.previousSibling)){const n=t.previousSibling.__ln.next;r.next=n,r.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=r,n&&(n.previous=r)}else if(t.nextSibling&&lt(t.nextSibling)&&t.nextSibling.__ln.previous){const n=t.nextSibling.__ln.previous;r.previous=n,r.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=r,n&&(n.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;r.next===null&&(this.tail=r),this.length++}removeNode(t){const r=t.__ln;this.head&&(r.previous?(r.previous.next=r.next,r.next?r.next.previous=r.previous:this.tail=r.previous):(this.head=r.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const ct=(e,t)=>`${e}@${t}`;class Er{constructor(){g(this,"frozen",!1),g(this,"locked",!1),g(this,"texts",[]),g(this,"attributes",[]),g(this,"attributeMap",new WeakMap),g(this,"removes",[]),g(this,"mapRemoves",[]),g(this,"movedMap",{}),g(this,"addedSet",new Set),g(this,"movedSet",new Set),g(this,"droppedSet",new Set),g(this,"mutationCb"),g(this,"blockClass"),g(this,"blockSelector"),g(this,"maskTextClass"),g(this,"maskTextSelector"),g(this,"inlineStylesheet"),g(this,"maskInputOptions"),g(this,"maskTextFn"),g(this,"maskInputFn"),g(this,"keepIframeSrcFn"),g(this,"recordCanvas"),g(this,"inlineImages"),g(this,"slimDOMOptions"),g(this,"dataURLOptions"),g(this,"doc"),g(this,"mirror"),g(this,"iframeManager"),g(this,"stylesheetManager"),g(this,"shadowDomManager"),g(this,"canvasManager"),g(this,"processedNodeManager"),g(this,"unattachedDoc"),g(this,"processMutations",t=>{t.forEach(this.processMutation),this.emit()}),g(this,"emit",()=>{if(this.frozen||this.locked)return;const t=[],r=new Set,n=new Dr,s=o=>{let d=o,u=me;for(;u===me;)d=d&&d.nextSibling,u=d&&this.mirror.getId(d);return u},i=o=>{if(!o.parentNode||!Lt(o)||o.parentNode.tagName==="TEXTAREA")return;const d=he(o.parentNode)?this.mirror.getId(xt(o)):this.mirror.getId(o.parentNode),u=s(o);if(d===-1||u===-1)return n.addNode(o);const h=ae(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:m=>{Dt(m,this.mirror)&&this.iframeManager.addIframe(m),Et(m,this.mirror)&&this.stylesheetManager.trackLinkElement(m),Ze(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(m,p)=>{this.iframeManager.attachIframe(m,p),this.shadowDomManager.observeAttachShadow(m)},onStylesheetLoad:(m,p)=>{this.stylesheetManager.attachLinkElement(m,p)}});h&&(t.push({parentId:d,nextId:u,node:h}),r.add(h.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const o of this.movedSet)dt(this.removes,o,this.mirror)&&!this.movedSet.has(o.parentNode)||i(o);for(const o of this.addedSet)!ut(this.droppedSet,o)&&!dt(this.removes,o,this.mirror)||ut(this.movedSet,o)?i(o):this.droppedSet.add(o);let a=null;for(;n.length;){let o=null;if(a){const d=this.mirror.getId(a.value.parentNode),u=s(a.value);d!==-1&&u!==-1&&(o=a)}if(!o){let d=n.tail;for(;d;){const u=d;if(d=d.previous,u){const h=this.mirror.getId(u.value.parentNode);if(s(u.value)===-1)continue;if(h!==-1){o=u;break}else{const p=u.value;if(p.parentNode&&p.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const y=p.parentNode.host;if(this.mirror.getId(y)!==-1){o=u;break}}}}}}if(!o){for(;n.head;)n.removeNode(n.head.value);break}a=o.previous,n.removeNode(o.value),i(o.value)}const l={texts:this.texts.map(o=>{const d=o.node;return d.parentNode&&d.parentNode.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(d.parentNode),{id:this.mirror.getId(d),value:o.value}}).filter(o=>!r.has(o.id)).filter(o=>this.mirror.has(o.id)),attributes:this.attributes.map(o=>{const{attributes:d}=o;if(typeof d.style=="string"){const u=JSON.stringify(o.styleDiff),h=JSON.stringify(o._unchangedStyles);u.length<d.style.length&&(u+h).split("var(").length===d.style.split("var(").length&&(d.style=o.styleDiff)}return{id:this.mirror.getId(o.node),attributes:d}}).filter(o=>!r.has(o.id)).filter(o=>this.mirror.has(o.id)),removes:this.removes,adds:t};!l.texts.length&&!l.attributes.length&&!l.removes.length&&!l.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(l))}),g(this,"genTextAreaValueMutation",t=>{let r=this.attributeMap.get(t);r||(r={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(r),this.attributeMap.set(t,r)),r.attributes.value=Array.from(t.childNodes,n=>n.textContent||"").join("")}),g(this,"processMutation",t=>{if(!He(t.target,this.mirror,this.slimDOMOptions))switch(t.type){case"characterData":{const r=t.target.textContent;!P(t.target,this.blockClass,this.blockSelector,!1)&&r!==t.oldValue&&this.texts.push({value:At(t.target,this.maskTextClass,this.maskTextSelector,!0)&&r?this.maskTextFn?this.maskTextFn(r,Tt(t.target)):r.replace(/[\S]/g,"*"):r,node:t.target});break}case"attributes":{const r=t.target;let n=t.attributeName,s=t.target.getAttribute(n);if(n==="value"){const a=Xe(r);s=Ue({element:r,maskInputOptions:this.maskInputOptions,tagName:r.tagName,type:a,value:s,maskInputFn:this.maskInputFn})}if(P(t.target,this.blockClass,this.blockSelector,!1)||s===t.oldValue)return;let i=this.attributeMap.get(t.target);if(r.tagName==="IFRAME"&&n==="src"&&!this.keepIframeSrcFn(s))if(!r.contentDocument)n="rr_src";else return;if(i||(i={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(i),this.attributeMap.set(t.target,i)),n==="type"&&r.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!Mt(r.tagName,n)&&(i.attributes[n]=vt(this.doc,re(r.tagName),re(n),s),n==="style")){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(l){this.unattachedDoc=this.doc}const a=this.unattachedDoc.createElement("span");t.oldValue&&a.setAttribute("style",t.oldValue);for(const l of Array.from(r.style)){const o=r.style.getPropertyValue(l),d=r.style.getPropertyPriority(l);o!==a.style.getPropertyValue(l)||d!==a.style.getPropertyPriority(l)?d===""?i.styleDiff[l]=o:i.styleDiff[l]=[o,d]:i._unchangedStyles[l]=[o,d]}for(const l of Array.from(a.style))r.style.getPropertyValue(l)===""&&(i.styleDiff[l]=!1)}break}case"childList":{if(P(t.target,this.blockClass,this.blockSelector,!0))return;if(t.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(t.target);return}t.addedNodes.forEach(r=>this.genAdds(r,t.target)),t.removedNodes.forEach(r=>{const n=this.mirror.getId(r),s=he(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);P(t.target,this.blockClass,this.blockSelector,!1)||He(r,this.mirror,this.slimDOMOptions)||!Nr(r,this.mirror)||(this.addedSet.has(r)?(Ve(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(t.target)&&n===-1||Ot(t.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[ct(n,s)]?Ve(this.movedSet,r):this.removes.push({parentId:s,id:n,isShadow:he(t.target)&&pe(t.target)?!0:void 0})),this.mapRemoves.push(r))});break}}}),g(this,"genAdds",(t,r)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!(this.addedSet.has(t)||this.movedSet.has(t))){if(this.mirror.hasNode(t)){if(He(t,this.mirror,this.slimDOMOptions))return;this.movedSet.add(t);let n=null;r&&this.mirror.hasNode(r)&&(n=this.mirror.getId(r)),n&&n!==-1&&(this.movedMap[ct(this.mirror.getId(t),n)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);P(t,this.blockClass,this.blockSelector,!1)||(t.childNodes.forEach(n=>this.genAdds(n)),Ze(t)&&t.shadowRoot.childNodes.forEach(n=>{this.processedNodeManager.add(n,this),this.genAdds(n,t)}))}})}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=t[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Ve(e,t){e.delete(t),t.childNodes.forEach(r=>Ve(e,r))}function dt(e,t,r){return e.length===0?!1:xr(e,t,r)}function xr(e,t,r){let n=t.parentNode;for(;n;){const s=r.getId(n);if(e.some(i=>i.id===s))return!0;n=n.parentNode}return!1}function ut(e,t){return e.size===0?!1:_t(e,t)}function _t(e,t){const{parentNode:r}=t;return r?e.has(r)?!0:_t(e,r):!1}let fe;function Lr(e){fe=e}function _r(){fe=void 0}const v=e=>fe?(...r)=>{try{return e(...r)}catch(n){if(fe&&fe(n)===!0)return;throw n}}:e,te=[];function ye(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(t){}return e&&e.target}function Ft(e,t){var r,n;const s=new Er;te.push(s),s.init(e);let i=window.MutationObserver||window.__rrMutationObserver;const a=(n=(r=window==null?void 0:window.Zone)==null?void 0:r.__symbol__)==null?void 0:n.call(r,"MutationObserver");a&&window[a]&&(i=window[a]);const l=new i(v(s.processMutations.bind(s)));return l.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),l}function Fr({mousemoveCb:e,sampling:t,doc:r,mirror:n}){if(t.mousemove===!1)return()=>{};const s=typeof t.mousemove=="number"?t.mousemove:50,i=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let a=[],l;const o=ge(v(h=>{const m=Date.now()-l;e(a.map(p=>(p.timeOffset-=m,p)),h),a=[],l=null}),i),d=v(ge(v(h=>{const m=ye(h),{clientX:p,clientY:y}=Ye(h)?h.changedTouches[0]:h;l||(l=De()),a.push({x:p,y,id:n.getId(m),timeOffset:De()-l}),o(typeof DragEvent!="undefined"&&h instanceof DragEvent?w.Drag:h instanceof MouseEvent?w.MouseMove:w.TouchMove)}),s,{trailing:!1})),u=[G("mousemove",d,r),G("touchmove",d,r),G("drag",d,r)];return v(()=>{u.forEach(h=>h())})}function Wr({mouseInteractionCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,sampling:i}){if(i.mouseInteraction===!1)return()=>{};const a=i.mouseInteraction===!0||i.mouseInteraction===void 0?{}:i.mouseInteraction,l=[];let o=null;const d=u=>h=>{const m=ye(h);if(P(m,n,s,!0))return;let p=null,y=u;if("pointerType"in h){switch(h.pointerType){case"mouse":p=j.Mouse;break;case"touch":p=j.Touch;break;case"pen":p=j.Pen;break}p===j.Touch?H[u]===H.MouseDown?y="TouchStart":H[u]===H.MouseUp&&(y="TouchEnd"):j.Pen}else Ye(h)&&(p=j.Touch);p!==null?(o=p,(y.startsWith("Touch")&&p===j.Touch||y.startsWith("Mouse")&&p===j.Mouse)&&(p=null)):H[u]===H.Click&&(p=o,o=null);const c=Ye(h)?h.changedTouches[0]:h;if(!c)return;const I=r.getId(m),{clientX:C,clientY:S}=c;v(e)(_({type:H[y],id:I,x:C,y:S},p!==null&&{pointerType:p}))};return Object.keys(H).filter(u=>Number.isNaN(Number(u))&&!u.endsWith("_Departed")&&a[u]!==!1).forEach(u=>{let h=re(u);const m=d(u);if(window.PointerEvent)switch(H[u]){case H.MouseDown:case H.MouseUp:h=h.replace("mouse","pointer");break;case H.TouchStart:case H.TouchEnd:return}l.push(G(h,m,t))}),v(()=>{l.forEach(u=>u())})}function Wt({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,sampling:i}){const a=v(ge(v(l=>{const o=ye(l);if(!o||P(o,n,s,!0))return;const d=r.getId(o);if(o===t&&t.defaultView){const u=Nt(t.defaultView);e({id:d,x:u.left,y:u.top})}else e({id:d,x:o.scrollLeft,y:o.scrollTop})}),i.scroll||100));return G("scroll",a,t)}function Gr({viewportResizeCb:e},{win:t}){let r=-1,n=-1;const s=v(ge(v(()=>{const i=kt(),a=Rt();(r!==i||n!==a)&&(e({width:Number(a),height:Number(i)}),r=i,n=a)}),200));return G("resize",s,t)}const Pr=["INPUT","TEXTAREA","SELECT"],ht=new WeakMap;function Br({inputCb:e,doc:t,mirror:r,blockClass:n,blockSelector:s,ignoreClass:i,ignoreSelector:a,maskInputOptions:l,maskInputFn:o,sampling:d,userTriggeredOnInput:u}){function h(S){let f=ye(S);const b=S.isTrusted,T=f&&f.tagName;if(f&&T==="OPTION"&&(f=f.parentElement),!f||!T||Pr.indexOf(T)<0||P(f,n,s,!0)||f.classList.contains(i)||a&&f.matches(a))return;let x=f.value,B=!1;const F=Xe(f)||"";F==="radio"||F==="checkbox"?B=f.checked:(l[T.toLowerCase()]||l[F])&&(x=Ue({element:f,maskInputOptions:l,tagName:T,type:F,value:x,maskInputFn:o})),m(f,u?{text:x,isChecked:B,userTriggered:b}:{text:x,isChecked:B});const X=f.name;F==="radio"&&X&&B&&t.querySelectorAll(`input[type="radio"][name="${X}"]`).forEach(z=>{if(z!==f){const Y=z.value;m(z,u?{text:Y,isChecked:!B,userTriggered:!1}:{text:Y,isChecked:!B})}})}function m(S,f){const b=ht.get(S);if(!b||b.text!==f.text||b.isChecked!==f.isChecked){ht.set(S,f);const T=r.getId(S);v(e)(we(_({},f),{id:T}))}}const y=(d.input==="last"?["change"]:["input","change"]).map(S=>G(S,v(h),t)),c=t.defaultView;if(!c)return()=>{y.forEach(S=>S())};const I=c.Object.getOwnPropertyDescriptor(c.HTMLInputElement.prototype,"value"),C=[[c.HTMLInputElement.prototype,"value"],[c.HTMLInputElement.prototype,"checked"],[c.HTMLSelectElement.prototype,"value"],[c.HTMLTextAreaElement.prototype,"value"],[c.HTMLSelectElement.prototype,"selectedIndex"],[c.HTMLOptionElement.prototype,"selected"]];return I&&I.set&&y.push(...C.map(S=>_e(S[0],S[1],{set(){v(h)({target:this,isTrusted:!1})}},!1,c))),v(()=>{y.forEach(S=>S())})}function Ee(e){const t=[];function r(n,s){if(ve("CSSGroupingRule")&&n.parentRule instanceof CSSGroupingRule||ve("CSSMediaRule")&&n.parentRule instanceof CSSMediaRule||ve("CSSSupportsRule")&&n.parentRule instanceof CSSSupportsRule||ve("CSSConditionRule")&&n.parentRule instanceof CSSConditionRule){const a=Array.from(n.parentRule.cssRules).indexOf(n);s.unshift(a)}else if(n.parentStyleSheet){const a=Array.from(n.parentStyleSheet.cssRules).indexOf(n);s.unshift(a)}return s}return r(e,t)}function Q(e,t,r){let n,s;return e?(e.ownerNode?n=t.getId(e.ownerNode):s=r.getId(e),{styleId:s,id:n}):{}}function Hr({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};const s=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:v((u,h,m)=>{const[p,y]=m,{id:c,styleId:I}=Q(h,t,r.styleMirror);return(c&&c!==-1||I&&I!==-1)&&e({id:c,styleId:I,adds:[{rule:p,index:y}]}),u.apply(h,m)})});const i=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=new Proxy(i,{apply:v((u,h,m)=>{const[p]=m,{id:y,styleId:c}=Q(h,t,r.styleMirror);return(y&&y!==-1||c&&c!==-1)&&e({id:y,styleId:c,removes:[{index:p}]}),u.apply(h,m)})});let a;n.CSSStyleSheet.prototype.replace&&(a=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(a,{apply:v((u,h,m)=>{const[p]=m,{id:y,styleId:c}=Q(h,t,r.styleMirror);return(y&&y!==-1||c&&c!==-1)&&e({id:y,styleId:c,replace:p}),u.apply(h,m)})}));let l;n.CSSStyleSheet.prototype.replaceSync&&(l=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(l,{apply:v((u,h,m)=>{const[p]=m,{id:y,styleId:c}=Q(h,t,r.styleMirror);return(y&&y!==-1||c&&c!==-1)&&e({id:y,styleId:c,replaceSync:p}),u.apply(h,m)})}));const o={};Me("CSSGroupingRule")?o.CSSGroupingRule=n.CSSGroupingRule:(Me("CSSMediaRule")&&(o.CSSMediaRule=n.CSSMediaRule),Me("CSSConditionRule")&&(o.CSSConditionRule=n.CSSConditionRule),Me("CSSSupportsRule")&&(o.CSSSupportsRule=n.CSSSupportsRule));const d={};return Object.entries(o).forEach(([u,h])=>{d[u]={insertRule:h.prototype.insertRule,deleteRule:h.prototype.deleteRule},h.prototype.insertRule=new Proxy(d[u].insertRule,{apply:v((m,p,y)=>{const[c,I]=y,{id:C,styleId:S}=Q(p.parentStyleSheet,t,r.styleMirror);return(C&&C!==-1||S&&S!==-1)&&e({id:C,styleId:S,adds:[{rule:c,index:[...Ee(p),I||0]}]}),m.apply(p,y)})}),h.prototype.deleteRule=new Proxy(d[u].deleteRule,{apply:v((m,p,y)=>{const[c]=y,{id:I,styleId:C}=Q(p.parentStyleSheet,t,r.styleMirror);return(I&&I!==-1||C&&C!==-1)&&e({id:I,styleId:C,removes:[{index:[...Ee(p),c]}]}),m.apply(p,y)})})}),v(()=>{n.CSSStyleSheet.prototype.insertRule=s,n.CSSStyleSheet.prototype.deleteRule=i,a&&(n.CSSStyleSheet.prototype.replace=a),l&&(n.CSSStyleSheet.prototype.replaceSync=l),Object.entries(o).forEach(([u,h])=>{h.prototype.insertRule=d[u].insertRule,h.prototype.deleteRule=d[u].deleteRule})})}function Gt({mirror:e,stylesheetManager:t},r){var n,s,i;let a=null;r.nodeName==="#document"?a=e.getId(r):a=e.getId(r.host);const l=r.nodeName==="#document"?(n=r.defaultView)==null?void 0:n.Document:(i=(s=r.ownerDocument)==null?void 0:s.defaultView)==null?void 0:i.ShadowRoot,o=l!=null&&l.prototype?Object.getOwnPropertyDescriptor(l==null?void 0:l.prototype,"adoptedStyleSheets"):void 0;return a===null||a===-1||!l||!o?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get(){var d;return(d=o.get)==null?void 0:d.call(this)},set(d){var u;const h=(u=o.set)==null?void 0:u.call(this,d);if(a!==null&&a!==-1)try{t.adoptStyleSheets(d,a)}catch(m){}return h}}),v(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get:o.get,set:o.set})}))}function zr({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:n},{win:s}){const i=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(i,{apply:v((l,o,d)=>{var u;const[h,m,p]=d;if(r.has(h))return i.apply(o,[h,m,p]);const{id:y,styleId:c}=Q((u=o.parentRule)==null?void 0:u.parentStyleSheet,t,n.styleMirror);return(y&&y!==-1||c&&c!==-1)&&e({id:y,styleId:c,set:{property:h,value:m,priority:p},index:Ee(o.parentRule)}),l.apply(o,d)})});const a=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(a,{apply:v((l,o,d)=>{var u;const[h]=d;if(r.has(h))return a.apply(o,[h]);const{id:m,styleId:p}=Q((u=o.parentRule)==null?void 0:u.parentStyleSheet,t,n.styleMirror);return(m&&m!==-1||p&&p!==-1)&&e({id:m,styleId:p,remove:{property:h},index:Ee(o.parentRule)}),l.apply(o,d)})}),v(()=>{s.CSSStyleDeclaration.prototype.setProperty=i,s.CSSStyleDeclaration.prototype.removeProperty=a})}function Yr({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:n,sampling:s,doc:i}){const a=v(o=>ge(v(d=>{const u=ye(d);if(!u||P(u,t,r,!0))return;const{currentTime:h,volume:m,muted:p,playbackRate:y,loop:c}=u;e({type:o,id:n.getId(u),currentTime:h,volume:m,muted:p,playbackRate:y,loop:c})}),s.media||500)),l=[G("play",a(oe.Play),i),G("pause",a(oe.Pause),i),G("seeked",a(oe.Seeked),i),G("volumechange",a(oe.VolumeChange),i),G("ratechange",a(oe.RateChange),i)];return v(()=>{l.forEach(o=>o())})}function Zr({fontCb:e,doc:t}){const r=t.defaultView;if(!r)return()=>{};const n=[],s=new WeakMap,i=r.FontFace;r.FontFace=function(o,d,u){const h=new i(o,d,u);return s.set(h,{family:o,buffer:typeof d!="string",descriptors:u,fontSource:typeof d=="string"?d:JSON.stringify(Array.from(new Uint8Array(d)))}),h};const a=de(t.fonts,"add",function(l){return function(o){return setTimeout(v(()=>{const d=s.get(o);d&&(e(d),s.delete(o))}),0),l.apply(this,[o])}});return n.push(()=>{r.FontFace=i}),n.push(a),v(()=>{n.forEach(l=>l())})}function Vr(e){const{doc:t,mirror:r,blockClass:n,blockSelector:s,selectionCb:i}=e;let a=!0;const l=v(()=>{const o=t.getSelection();if(!o||a&&(o!=null&&o.isCollapsed))return;a=o.isCollapsed||!1;const d=[],u=o.rangeCount||0;for(let h=0;h<u;h++){const m=o.getRangeAt(h),{startContainer:p,startOffset:y,endContainer:c,endOffset:I}=m;P(p,n,s,!0)||P(c,n,s,!0)||d.push({start:r.getId(p),startOffset:y,end:r.getId(c),endOffset:I})}i({ranges:d})});return l(),G("selectionchange",l)}function Ur({doc:e,customElementCb:t}){const r=e.defaultView;return!r||!r.customElements?()=>{}:de(r.customElements,"define",function(s){return function(i,a,l){try{t({define:{name:i}})}catch(o){console.warn(`Custom element callback failed for ${i}`)}return s.apply(this,[i,a,l])}})}function Xr(e,t){const{mutationCb:r,mousemoveCb:n,mouseInteractionCb:s,scrollCb:i,viewportResizeCb:a,inputCb:l,mediaInteractionCb:o,styleSheetRuleCb:d,styleDeclarationCb:u,canvasMutationCb:h,fontCb:m,selectionCb:p,customElementCb:y}=e;e.mutationCb=(...c)=>{t.mutation&&t.mutation(...c),r(...c)},e.mousemoveCb=(...c)=>{t.mousemove&&t.mousemove(...c),n(...c)},e.mouseInteractionCb=(...c)=>{t.mouseInteraction&&t.mouseInteraction(...c),s(...c)},e.scrollCb=(...c)=>{t.scroll&&t.scroll(...c),i(...c)},e.viewportResizeCb=(...c)=>{t.viewportResize&&t.viewportResize(...c),a(...c)},e.inputCb=(...c)=>{t.input&&t.input(...c),l(...c)},e.mediaInteractionCb=(...c)=>{t.mediaInteaction&&t.mediaInteaction(...c),o(...c)},e.styleSheetRuleCb=(...c)=>{t.styleSheetRule&&t.styleSheetRule(...c),d(...c)},e.styleDeclarationCb=(...c)=>{t.styleDeclaration&&t.styleDeclaration(...c),u(...c)},e.canvasMutationCb=(...c)=>{t.canvasMutation&&t.canvasMutation(...c),h(...c)},e.fontCb=(...c)=>{t.font&&t.font(...c),m(...c)},e.selectionCb=(...c)=>{t.selection&&t.selection(...c),p(...c)},e.customElementCb=(...c)=>{t.customElement&&t.customElement(...c),y(...c)}}function Jr(e,t={}){const r=e.doc.defaultView;if(!r)return()=>{};Xr(e,t);let n;e.recordDOM&&(n=Ft(e,e.doc));const s=Fr(e),i=Wr(e),a=Wt(e),l=Gr(e,{win:r}),o=Br(e),d=Yr(e);let u=()=>{},h=()=>{},m=()=>{},p=()=>{};e.recordDOM&&(u=Hr(e,{win:r}),h=Gt(e,e.doc),m=zr(e,{win:r}),e.collectFonts&&(p=Zr(e)));const y=Vr(e),c=Ur(e),I=[];for(const C of e.plugins)I.push(C.observer(C.callback,r,C.options));return v(()=>{te.forEach(C=>C.reset()),n==null||n.disconnect(),s(),i(),a(),l(),o(),d(),u(),h(),m(),p(),y(),c(),I.forEach(C=>C())})}function ve(e){return typeof window[e]!="undefined"}function Me(e){return!!(typeof window[e]!="undefined"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class pt{constructor(t){g(this,"iframeIdToRemoteIdMap",new WeakMap),g(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=t}getId(t,r,n,s){const i=n||this.getIdToRemoteIdMap(t),a=s||this.getRemoteIdToIdMap(t);let l=i.get(r);return l||(l=this.generateIdFn(),i.set(r,l),a.set(l,r)),l}getIds(t,r){const n=this.getIdToRemoteIdMap(t),s=this.getRemoteIdToIdMap(t);return r.map(i=>this.getId(t,i,n,s))}getRemoteId(t,r,n){const s=n||this.getRemoteIdToIdMap(t);if(typeof r!="number")return r;const i=s.get(r);return i||-1}getRemoteIds(t,r){const n=this.getRemoteIdToIdMap(t);return r.map(s=>this.getRemoteId(t,s,n))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let r=this.iframeIdToRemoteIdMap.get(t);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(t,r)),r}getRemoteIdToIdMap(t){let r=this.iframeRemoteIdToIdMap.get(t);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(t,r)),r}}class jr{constructor(t){g(this,"iframes",new WeakMap),g(this,"crossOriginIframeMap",new WeakMap),g(this,"crossOriginIframeMirror",new pt(wt)),g(this,"crossOriginIframeStyleMirror"),g(this,"crossOriginIframeRootIdMap",new WeakMap),g(this,"mirror"),g(this,"mutationCb"),g(this,"wrappedEmit"),g(this,"loadListener"),g(this,"stylesheetManager"),g(this,"recordCrossOriginIframes"),this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new pt(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,r){var n,s;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&((n=t.contentWindow)==null||n.addEventListener("message",this.handleMessage.bind(this))),(s=this.loadListener)==null||s.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const r=t;if(r.data.type!=="rrweb"||r.origin!==r.data.origin||!t.source)return;const s=this.crossOriginIframeMap.get(t.source);if(!s)return;const i=this.transformCrossOriginEvent(s,r.data.event);i&&this.wrappedEmit(i,r.data.isCheckout)}transformCrossOriginEvent(t,r){var n;switch(r.type){case M.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(r.data.node,t);const s=r.data.node.id;return this.crossOriginIframeRootIdMap.set(t,s),this.patchRootIdOnNode(r.data.node,s),{timestamp:r.timestamp,type:M.IncrementalSnapshot,data:{source:w.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case M.Meta:case M.Load:case M.DomContentLoaded:return!1;case M.Plugin:return r;case M.Custom:return this.replaceIds(r.data.payload,t,["id","parentId","previousId","nextId"]),r;case M.IncrementalSnapshot:switch(r.data.source){case w.Mutation:return r.data.adds.forEach(s=>{this.replaceIds(s,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(s.node,t);const i=this.crossOriginIframeRootIdMap.get(t);i&&this.patchRootIdOnNode(s.node,i)}),r.data.removes.forEach(s=>{this.replaceIds(s,t,["parentId","id"])}),r.data.attributes.forEach(s=>{this.replaceIds(s,t,["id"])}),r.data.texts.forEach(s=>{this.replaceIds(s,t,["id"])}),r;case w.Drag:case w.TouchMove:case w.MouseMove:return r.data.positions.forEach(s=>{this.replaceIds(s,t,["id"])}),r;case w.ViewportResize:return!1;case w.MediaInteraction:case w.MouseInteraction:case w.Scroll:case w.CanvasMutation:case w.Input:return this.replaceIds(r.data,t,["id"]),r;case w.StyleSheetRule:case w.StyleDeclaration:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleId"]),r;case w.Font:return r;case w.Selection:return r.data.ranges.forEach(s=>{this.replaceIds(s,t,["start","end"])}),r;case w.AdoptedStyleSheet:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleIds"]),(n=r.data.styles)==null||n.forEach(s=>{this.replaceStyleIds(s,t,["styleId"])}),r}}return!1}replace(t,r,n,s){for(const i of s)!Array.isArray(r[i])&&typeof r[i]!="number"||(Array.isArray(r[i])?r[i]=t.getIds(n,r[i]):r[i]=t.getId(n,r[i]));return r}replaceIds(t,r,n){return this.replace(this.crossOriginIframeMirror,t,r,n)}replaceStyleIds(t,r,n){return this.replace(this.crossOriginIframeStyleMirror,t,r,n)}replaceIdOnNode(t,r){this.replaceIds(t,r,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(n=>{this.replaceIdOnNode(n,r)})}patchRootIdOnNode(t,r){t.type!==L.Document&&!t.rootId&&(t.rootId=r),"childNodes"in t&&t.childNodes.forEach(n=>{this.patchRootIdOnNode(n,r)})}}class Kr{constructor(t){g(this,"shadowDoms",new WeakSet),g(this,"mutationCb"),g(this,"scrollCb"),g(this,"bypassOptions"),g(this,"mirror"),g(this,"restoreHandlers",[]),this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,r){if(!pe(t)||this.shadowDoms.has(t))return;this.shadowDoms.add(t);const n=Ft(we(_({},this.bypassOptions),{doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(Wt(we(_({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push(Gt({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){!t.contentWindow||!t.contentDocument||this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,r){const n=this;this.restoreHandlers.push(de(t.prototype,"attachShadow",function(s){return function(i){const a=s.call(this,i);return this.shadowRoot&&Lt(this)&&n.addShadowRoot(this.shadowRoot,r),a}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch(r){}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}var le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qr=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(var Ae=0;Ae<le.length;Ae++)Qr[le.charCodeAt(Ae)]=Ae;var $r=function(e){var t=new Uint8Array(e),r,n=t.length,s="";for(r=0;r<n;r+=3)s+=le[t[r]>>2],s+=le[(t[r]&3)<<4|t[r+1]>>4],s+=le[(t[r+1]&15)<<2|t[r+2]>>6],s+=le[t[r+2]&63];return n%3===2?s=s.substring(0,s.length-1)+"=":n%3===1&&(s=s.substring(0,s.length-2)+"=="),s};const ft=new Map;function qr(e,t){let r=ft.get(e);return r||(r=new Map,ft.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}const Pt=(e,t,r)=>{if(!e||!(Ht(e,t)||typeof e=="object"))return;const n=e.constructor.name,s=qr(r,n);let i=s.indexOf(e);return i===-1&&(i=s.length,s.push(e)),i};function Ne(e,t,r){if(e instanceof Array)return e.map(n=>Ne(n,t,r));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const n=e.constructor.name,s=$r(e);return{rr_type:n,base64:s}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Ne(e.buffer,t,r),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const n=e.constructor.name,{src:s}=e;return{rr_type:n,src:s}}else if(e instanceof HTMLCanvasElement){const n="HTMLImageElement",s=e.toDataURL();return{rr_type:n,src:s}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[Ne(e.data,t,r),e.width,e.height]};if(Ht(e,t)||typeof e=="object"){const n=e.constructor.name,s=Pt(e,t,r);return{rr_type:n,index:s}}}}return e}const Bt=(e,t,r)=>e.map(n=>Ne(n,t,r)),Ht=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(s=>typeof t[s]=="function").find(s=>e instanceof t[s]);function en(e,t,r,n){const s=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const a of i)try{if(typeof t.CanvasRenderingContext2D.prototype[a]!="function")continue;const l=de(t.CanvasRenderingContext2D.prototype,a,function(o){return function(...d){return P(this.canvas,r,n,!0)||setTimeout(()=>{const u=Bt(d,t,this);e(this.canvas,{type:ce["2D"],property:a,args:u})},0),o.apply(this,d)}});s.push(l)}catch(l){const o=_e(t.CanvasRenderingContext2D.prototype,a,{set(d){e(this.canvas,{type:ce["2D"],property:a,args:[d],setter:!0})}});s.push(o)}return()=>{s.forEach(a=>a())}}function tn(e){return e==="experimental-webgl"?"webgl":e}function mt(e,t,r,n){const s=[];try{const i=de(e.HTMLCanvasElement.prototype,"getContext",function(a){return function(l,...o){if(!P(this,t,r,!0)){const d=tn(l);if("__context"in this||(this.__context=d),n&&["webgl","webgl2"].includes(d))if(o[0]&&typeof o[0]=="object"){const u=o[0];u.preserveDrawingBuffer||(u.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return a.apply(this,[l,...o])}});s.push(i)}catch(i){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach(i=>i())}}function gt(e,t,r,n,s,i,a){const l=[],o=Object.getOwnPropertyNames(e);for(const d of o)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(d))try{if(typeof e[d]!="function")continue;const u=de(e,d,function(h){return function(...m){const p=h.apply(this,m);if(Pt(p,a,this),"tagName"in this.canvas&&!P(this.canvas,n,s,!0)){const y=Bt(m,a,this),c={type:t,property:d,args:y};r(this.canvas,c)}return p}});l.push(u)}catch(u){const h=_e(e,d,{set(m){r(this.canvas,{type:t,property:d,args:[m],setter:!0})}});l.push(h)}return l}function rn(e,t,r,n,s){const i=[];return i.push(...gt(t.WebGLRenderingContext.prototype,ce.WebGL,e,r,n,s,t)),typeof t.WebGL2RenderingContext!="undefined"&&i.push(...gt(t.WebGL2RenderingContext.prototype,ce.WebGL2,e,r,n,s,t)),()=>{i.forEach(a=>a())}}const zt="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiI7CiAgICB9CiAgfQogIGNvbnN0IHdvcmtlciA9IHNlbGY7CiAgd29ya2VyLm9ubWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsKICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMgfSA9IGUuZGF0YTsKICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3IoCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGRhdGFVUkxPcHRpb25zCiAgICAgICk7CiAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjdHguZHJhd0ltYWdlKGJpdG1hcCwgMCwgMCk7CiAgICAgIGJpdG1hcC5jbG9zZSgpOwogICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICBjb25zdCB0eXBlID0gYmxvYi50eXBlOwogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTsKICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgaWYgKCFsYXN0QmxvYk1hcC5oYXMoaWQpICYmIGF3YWl0IHRyYW5zcGFyZW50QmFzZTY0ID09PSBiYXNlNjQpIHsKICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB9CiAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpCiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB3b3JrZXIucG9zdE1lc3NhZ2UoewogICAgICAgIGlkLAogICAgICAgIHR5cGUsCiAgICAgICAgYmFzZTY0LAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9KTsKICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkOiBlLmRhdGEuaWQgfSk7CiAgICB9CiAgfTsKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYml0bWFwLWRhdGEtdXJsLXdvcmtlci1CWjFyN1JKRC5qcy5tYXAK",nn=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),yt=typeof window!="undefined"&&window.Blob&&new Blob([nn(zt)],{type:"text/javascript;charset=utf-8"});function sn(e){let t;try{if(t=yt&&(window.URL||window.webkitURL).createObjectURL(yt),!t)throw"";const r=new Worker(t,{name:e==null?void 0:e.name});return r.addEventListener("error",()=>{(window.URL||window.webkitURL).revokeObjectURL(t)}),r}catch(r){return new Worker("data:text/javascript;base64,"+zt,{name:e==null?void 0:e.name})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}class on{constructor(t){g(this,"pendingCanvasMutations",new Map),g(this,"rafStamps",{latestId:0,invokeId:null}),g(this,"mirror"),g(this,"mutationCb"),g(this,"resetObservers"),g(this,"frozen",!1),g(this,"locked",!1),g(this,"processMutation",(o,d)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(o)||this.pendingCanvasMutations.set(o,[]),this.pendingCanvasMutations.get(o).push(d)});const{sampling:r="all",win:n,blockClass:s,blockSelector:i,recordCanvas:a,dataURLOptions:l}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,a&&r==="all"&&this.initCanvasMutationObserver(n,s,i),a&&typeof r=="number"&&this.initCanvasFPSObserver(r,n,s,i,{dataURLOptions:l})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(t,r,n,s,i){const a=mt(r,n,s,!0),l=new Map,o=new sn;o.onmessage=y=>{const{id:c}=y.data;if(l.set(c,!1),!("base64"in y.data))return;const{base64:I,type:C,width:S,height:f}=y.data;this.mutationCb({id:c,type:ce["2D"],commands:[{property:"clearRect",args:[0,0,S,f]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:I}],type:C}]},0,0]}]})};const d=1e3/t;let u=0,h;const m=()=>{const y=[];return r.document.querySelectorAll("canvas").forEach(c=>{P(c,n,s,!0)||y.push(c)}),y},p=y=>{if(u&&y-u<d){h=requestAnimationFrame(p);return}u=y,m().forEach(async c=>{var I;const C=this.mirror.getId(c);if(l.get(C)||c.width===0||c.height===0)return;if(l.set(C,!0),["webgl","webgl2"].includes(c.__context)){const f=c.getContext(c.__context);((I=f==null?void 0:f.getContextAttributes())==null?void 0:I.preserveDrawingBuffer)===!1&&f.clear(f.COLOR_BUFFER_BIT)}const S=await createImageBitmap(c);o.postMessage({id:C,bitmap:S,width:c.width,height:c.height,dataURLOptions:i.dataURLOptions},[S])}),h=requestAnimationFrame(p)};h=requestAnimationFrame(p),this.resetObservers=()=>{a(),cancelAnimationFrame(h)}}initCanvasMutationObserver(t,r,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const s=mt(t,r,n,!1),i=en(this.processMutation.bind(this),t,r,n),a=rn(this.processMutation.bind(this),t,r,n,this.mirror);this.resetObservers=()=>{s(),i(),a()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=r=>{this.rafStamps.latestId=r,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,r)=>{const n=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,r){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(t);if(!n||r===-1)return;const s=n.map(a=>{const d=a,{type:l}=d;return tt(d,["type"])}),{type:i}=n[0];this.mutationCb({id:r,type:i,commands:s}),this.pendingCanvasMutations.delete(t)}}class an{constructor(t){g(this,"trackedLinkElements",new WeakSet),g(this,"mutationCb"),g(this,"adoptedStyleSheetCb"),g(this,"styleMirror",new Rr),this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,r){if(t.length===0)return;const n={id:r,styleIds:[]},s=[];for(const i of t){let a;this.styleMirror.has(i)?a=this.styleMirror.getId(i):(a=this.styleMirror.add(i),s.push({styleId:a,rules:Array.from(i.rules||CSSRule,(l,o)=>({rule:St(l),index:o}))})),n.styleIds.push(a)}s.length>0&&(n.styles=s),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class ln{constructor(){g(this,"nodeMap",new WeakMap),g(this,"active",!1)}inOtherBuffer(t,r){const n=this.nodeMap.get(t);return n&&Array.from(n).some(s=>s!==r)}add(t,r){this.active||(this.active=!0,requestAnimationFrame(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(r))}destroy(){}}let E,ke,ze,xe=!1;try{if(Array.from([1],e=>e*2)[0]!==2){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=((rt=e.contentWindow)==null?void 0:rt.Array.from)||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}const U=nr();function Ie(e={}){const{emit:t,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:s="rr-block",blockSelector:i=null,ignoreClass:a="rr-ignore",ignoreSelector:l=null,maskTextClass:o="rr-mask",maskTextSelector:d=null,inlineStylesheet:u=!0,maskAllInputs:h,maskInputOptions:m,slimDOMOptions:p,maskInputFn:y,maskTextFn:c,hooks:I,packFn:C,sampling:S={},dataURLOptions:f={},mousemoveWait:b,recordDOM:T=!0,recordCanvas:x=!1,recordCrossOriginIframes:B=!1,recordAfter:F=e.recordAfter==="DOMContentLoaded"?e.recordAfter:"load",userTriggeredOnInput:X=!1,collectFonts:z=!1,inlineImages:Y=!1,plugins:A,keepIframeSrcFn:$=()=>!1,ignoreCSSAttributes:W=new Set([]),errorHandler:K}=e;Lr(K);const Z=B?window.parent===window:!0;let ue=!1;if(!Z)try{window.parent.document&&(ue=!1)}catch(N){ue=!0}if(Z&&!t)throw new Error("emit function is required");if(!Z&&!ue)return()=>{};b!==void 0&&S.mousemove===void 0&&(S.mousemove=b),U.reset();const Fe=h===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:m!==void 0?m:{password:!0},We=p===!0||p==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:p==="all",headMetaDescKeywords:p==="all",headTitleMutations:p==="all"}:p||{};kr();let Je,Ge=0;const je=N=>{for(const V of A||[])V.eventProcessor&&(N=V.eventProcessor(N));return C&&!ue&&(N=C(N)),N};E=(N,V)=>{var O;const D=N;if(D.timestamp=De(),(O=te[0])!=null&&O.isFrozen()&&D.type!==M.FullSnapshot&&!(D.type===M.IncrementalSnapshot&&D.data.source===w.Mutation)&&te.forEach(J=>J.unfreeze()),Z)t==null||t(je(D),V);else if(ue){const J={type:"rrweb",event:je(D),origin:window.location.origin,isCheckout:V};window.parent.postMessage(J,"*")}if(D.type===M.FullSnapshot)Je=D,Ge=0;else if(D.type===M.IncrementalSnapshot){if(D.data.source===w.Mutation&&D.data.isAttachIframe)return;Ge++;const J=n&&Ge>=n,k=r&&D.timestamp-Je.timestamp>r;(J||k)&&ke(!0)}};const Se=N=>{E({type:M.IncrementalSnapshot,data:_({source:w.Mutation},N)})},Ke=N=>E({type:M.IncrementalSnapshot,data:_({source:w.Scroll},N)}),Qe=N=>E({type:M.IncrementalSnapshot,data:_({source:w.CanvasMutation},N)}),Yt=N=>E({type:M.IncrementalSnapshot,data:_({source:w.AdoptedStyleSheet},N)}),q=new an({mutationCb:Se,adoptedStyleSheetCb:Yt}),ee=new jr({mirror:U,mutationCb:Se,stylesheetManager:q,recordCrossOriginIframes:B,wrappedEmit:E});for(const N of A||[])N.getMirror&&N.getMirror({nodeMirror:U,crossOriginIframeMirror:ee.crossOriginIframeMirror,crossOriginIframeStyleMirror:ee.crossOriginIframeStyleMirror});const Pe=new ln;ze=new on({recordCanvas:x,mutationCb:Qe,win:window,blockClass:s,blockSelector:i,mirror:U,sampling:S.canvas,dataURLOptions:f});const Ce=new Kr({mutationCb:Se,scrollCb:Ke,bypassOptions:{blockClass:s,blockSelector:i,maskTextClass:o,maskTextSelector:d,inlineStylesheet:u,maskInputOptions:Fe,dataURLOptions:f,maskTextFn:c,maskInputFn:y,recordCanvas:x,inlineImages:Y,sampling:S,slimDOMOptions:We,iframeManager:ee,stylesheetManager:q,canvasManager:ze,keepIframeSrcFn:$,processedNodeManager:Pe},mirror:U});ke=(N=!1)=>{if(!T)return;E({type:M.Meta,data:{href:window.location.href,width:Rt(),height:kt()}},N),q.reset(),Ce.init(),te.forEach(O=>O.lock());const V=Ar(document,{mirror:U,blockClass:s,blockSelector:i,maskTextClass:o,maskTextSelector:d,inlineStylesheet:u,maskAllInputs:Fe,maskTextFn:c,slimDOM:We,dataURLOptions:f,recordCanvas:x,inlineImages:Y,onSerialize:O=>{Dt(O,U)&&ee.addIframe(O),Et(O,U)&&q.trackLinkElement(O),Ze(O)&&Ce.addShadowRoot(O.shadowRoot,document)},onIframeLoad:(O,D)=>{ee.attachIframe(O,D),Ce.observeAttachShadow(O)},onStylesheetLoad:(O,D)=>{q.attachLinkElement(O,D)},keepIframeSrcFn:$});if(!V)return console.warn("Failed to snapshot the document");E({type:M.FullSnapshot,data:{node:V,initialOffset:Nt(window)}},N),te.forEach(O=>O.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&q.adoptStyleSheets(document.adoptedStyleSheets,U.getId(document))};try{const N=[],V=D=>{var J;return v(Jr)({mutationCb:Se,mousemoveCb:(k,Be)=>E({type:M.IncrementalSnapshot,data:{source:Be,positions:k}}),mouseInteractionCb:k=>E({type:M.IncrementalSnapshot,data:_({source:w.MouseInteraction},k)}),scrollCb:Ke,viewportResizeCb:k=>E({type:M.IncrementalSnapshot,data:_({source:w.ViewportResize},k)}),inputCb:k=>E({type:M.IncrementalSnapshot,data:_({source:w.Input},k)}),mediaInteractionCb:k=>E({type:M.IncrementalSnapshot,data:_({source:w.MediaInteraction},k)}),styleSheetRuleCb:k=>E({type:M.IncrementalSnapshot,data:_({source:w.StyleSheetRule},k)}),styleDeclarationCb:k=>E({type:M.IncrementalSnapshot,data:_({source:w.StyleDeclaration},k)}),canvasMutationCb:Qe,fontCb:k=>E({type:M.IncrementalSnapshot,data:_({source:w.Font},k)}),selectionCb:k=>{E({type:M.IncrementalSnapshot,data:_({source:w.Selection},k)})},customElementCb:k=>{E({type:M.IncrementalSnapshot,data:_({source:w.CustomElement},k)})},blockClass:s,ignoreClass:a,ignoreSelector:l,maskTextClass:o,maskTextSelector:d,maskInputOptions:Fe,inlineStylesheet:u,sampling:S,recordDOM:T,recordCanvas:x,inlineImages:Y,userTriggeredOnInput:X,collectFonts:z,doc:D,maskInputFn:y,maskTextFn:c,keepIframeSrcFn:$,blockSelector:i,slimDOMOptions:We,dataURLOptions:f,mirror:U,iframeManager:ee,stylesheetManager:q,shadowDomManager:Ce,processedNodeManager:Pe,canvasManager:ze,ignoreCSSAttributes:W,plugins:((J=A==null?void 0:A.filter(k=>k.observer))==null?void 0:J.map(k=>({observer:k.observer,options:k.options,callback:Be=>E({type:M.Plugin,data:{plugin:k.name,payload:Be}})})))||[]},I)};ee.addLoadListener(D=>{try{N.push(V(D.contentDocument))}catch(J){console.warn(J)}});const O=()=>{ke(),N.push(V(document)),xe=!0};return document.readyState==="interactive"||document.readyState==="complete"?O():(N.push(G("DOMContentLoaded",()=>{E({type:M.DomContentLoaded,data:{}}),F==="DOMContentLoaded"&&O()})),N.push(G("load",()=>{E({type:M.Load,data:{}}),F==="load"&&O()},window))),()=>{N.forEach(D=>D()),Pe.destroy(),xe=!1,_r()}}catch(N){console.warn(N)}}Ie.addCustomEvent=(e,t)=>{if(!xe)throw new Error("please add custom event after start recording");E({type:M.Custom,data:{tag:e,payload:t}})};Ie.freezePage=()=>{te.forEach(e=>e.freeze())};Ie.takeFullSnapshot=e=>{if(!xe)throw new Error("please take full snapshot after start recording");ke(e)};Ie.mirror=U;var It;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(It||(It={}));exports.record=Ie;
if (typeof module.exports == "object" && typeof exports == "object") {
  var __cp = (to, from, except, desc) => {
    if ((from && typeof from === "object") || typeof from === "function") {
      for (let key of Object.getOwnPropertyNames(from)) {
        if (!Object.prototype.hasOwnProperty.call(to, key) && key !== except)
        Object.defineProperty(to, key, {
          get: () => from[key],
          enumerable: !(desc = Object.getOwnPropertyDescriptor(from, key)) || desc.enumerable,
        });
      }
    }
    return to;
  };
  module.exports = __cp(module.exports, exports);
}
return module.exports;
}))
